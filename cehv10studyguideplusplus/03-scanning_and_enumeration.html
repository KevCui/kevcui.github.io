
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>03-Scanning and Enumeration Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-advanced-emoji/emoji-website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="04-sniffing_and_evasion.html" />
    
    
    <link rel="prev" href="02-reconnaissance_and_footprinting.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    CEHv10 Study Guide++
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="01-essential_knowledge.html">
            
                <a href="01-essential_knowledge.html">
            
                    
                    01-Essential Knowledge
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="02-reconnaissance_and_footprinting.html">
            
                <a href="02-reconnaissance_and_footprinting.html">
            
                    
                    02-Reconnaissance and Footprinting
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4" data-path="03-scanning_and_enumeration.html">
            
                <a href="03-scanning_and_enumeration.html">
            
                    
                    03-Scanning and Enumeration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="04-sniffing_and_evasion.html">
            
                <a href="04-sniffing_and_evasion.html">
            
                    
                    04-Sniffing and Evasion
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="05-system_hacking.html">
            
                <a href="05-system_hacking.html">
            
                    
                    05-System Hacking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="06-web_server_and_web_application_hacking.html">
            
                <a href="06-web_server_and_web_application_hacking.html">
            
                    
                    06-Web Server and Web Application Hacking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="07-wireless_network_hacking.html">
            
                <a href="07-wireless_network_hacking.html">
            
                    
                    07-Wireless Network Hacking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="08-mobile_and_iot_hacking.html">
            
                <a href="08-mobile_and_iot_hacking.html">
            
                    
                    08-Mobile and IoT Hacking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="09-security_in_cloud_computing.html">
            
                <a href="09-security_in_cloud_computing.html">
            
                    
                    09-Security in Cloud Computing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="10-malware_and_other_attacks.html">
            
                <a href="10-malware_and_other_attacks.html">
            
                    
                    10-Malware and Other Attacks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="11-cryptography.html">
            
                <a href="11-cryptography.html">
            
                    
                    11-Cryptography
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="12-social_engineering.html">
            
                <a href="12-social_engineering.html">
            
                    
                    12-Social Engineering
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="13-pen_testing.html">
            
                <a href="13-pen_testing.html">
            
                    
                    13-Pen Testing
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >03-Scanning and Enumeration</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="03-scanning-and-enumeration">03-Scanning and Enumeration</h1>
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="03-scanning_and_enumeration.html#scanning-and-enumeration">Scanning and Enumeration</a><ul>
<li><a href="03-scanning_and_enumeration.html#scanning">Scanning</a><ul>
<li><a href="03-scanning_and_enumeration.html#data-transition-methods">Data transition methods</a></li>
<li><a href="03-scanning_and_enumeration.html#scanning-methodology">Scanning Methodology</a></li>
<li><a href="03-scanning_and_enumeration.html#tcpip-transmission-control-protocolinternet-protocol">TCP/IP (Transmission Control Protocol/Internet Protocol)</a><ul>
<li><a href="03-scanning_and_enumeration.html#tcp-flags">TCP Flags</a></li>
<li><a href="03-scanning_and_enumeration.html#tcp-handshake">TCP Handshake</a></li>
<li><a href="03-scanning_and_enumeration.html#port-numbers">Port Numbers</a></li>
<li><a href="03-scanning_and_enumeration.html#subnetting">Subnetting</a></li>
</ul>
</li>
<li><a href="03-scanning_and_enumeration.html#icmp-internet-control-message-protocol">ICMP (Internet Control Message Protocol)</a><ul>
<li><a href="03-scanning_and_enumeration.html#message-types">Message Types</a></li>
<li><a href="03-scanning_and_enumeration.html#ping-scanning-tools">Ping scanning tools</a></li>
</ul>
</li>
<li><a href="03-scanning_and_enumeration.html#vulnerability-scanning">Vulnerability Scanning</a></li>
</ul>
</li>
<li><a href="03-scanning_and_enumeration.html#enumeration">Enumeration</a><ul>
<li><a href="03-scanning_and_enumeration.html#netbios-network-basic-inputoutput-system-enumeration">NetBIOS (Network Basic Input/Output System) Enumeration</a><ul>
<li><a href="03-scanning_and_enumeration.html#netbios-code-and-meaning">NetBIOS code and meaning</a></li>
</ul>
</li>
<li><a href="03-scanning_and_enumeration.html#snmp-simple-network-management-protocol-enumeration">SNMP (Simple Network Management Protocol) Enumeration</a></li>
<li><a href="03-scanning_and_enumeration.html#smtp-simple-mail-transfer-protocol-enumeration">SMTP (Simple Mail Transfer Protocol) Enumeration</a></li>
<li><a href="03-scanning_and_enumeration.html#ntp-network-time-protocol-enumeration">NTP (Network Time Protocol) Enumeration</a></li>
<li><a href="03-scanning_and_enumeration.html#ldap-lightweight-directory-access-protocol-enumeration">LDAP (Lightweight Directory Access Protocol) Enumeration</a></li>
</ul>
</li>
<li><a href="03-scanning_and_enumeration.html#nmap">Nmap</a><ul>
<li><a href="03-scanning_and_enumeration.html#full-connect-scan">Full connect scan</a></li>
<li><a href="03-scanning_and_enumeration.html#tcp-syn-scan-stealth-scan">TCP SYN scan (Stealth scan)</a><ul>
<li><a href="03-scanning_and_enumeration.html#responses-to-full-and-syn-scan-probe">Responses to Full and SYN scan probe</a></li>
</ul>
</li>
<li><a href="03-scanning_and_enumeration.html#inverse-tcp-flag-scan-fin-urg-and-psh-scanning">Inverse TCP flag scan (FIN, URG and PSH scanning)</a></li>
<li><a href="03-scanning_and_enumeration.html#null-scan">NULL scan</a></li>
<li><a href="03-scanning_and_enumeration.html#xmas-scan">Xmas scan</a><ul>
<li><a href="03-scanning_and_enumeration.html#responses-to-a-null-fin-or-xmas-scan">Responses to a NULL, FIN, or Xmas scan</a></li>
</ul>
</li>
<li><a href="03-scanning_and_enumeration.html#tcp-ack-scan">TCP ACK scan</a></li>
<li><a href="03-scanning_and_enumeration.html#idle-scan">IDLE Scan</a></li>
<li><a href="03-scanning_and_enumeration.html#nmap-switches">Nmap Switches</a></li>
</ul>
</li>
<li><a href="03-scanning_and_enumeration.html#hping">hping</a><ul>
<li><a href="03-scanning_and_enumeration.html#hping-switch-and-description">hping switch and description</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="scanning-and-enumeration">Scanning and Enumeration</h2>
<h3 id="scanning">Scanning</h3>
<ul>
<li>Discovering systems on the network and looking at what ports are open as well as applications that may be running</li>
</ul>
<h4 id="data-transition-methods">Data transition methods</h4>
<ul>
<li><strong>Connectionless Communication</strong>: UDP (User Datagram Protocol) packets are sent without creating a connection. Examples are TFTP, DNS (lookups only) and DHCP</li>
<li><strong>Connection-Oriented Communication</strong>: TCP packets require a connection due to the size of the data being transmitted and to ensure deliverability</li>
</ul>
<h4 id="scanning-methodology">Scanning Methodology</h4>
<ol>
<li><strong>Check for live systems</strong>: ping or other type of way to determine live hosts</li>
<li><strong>Check for open ports</strong>: once you know live host IPs, scan them for listening ports</li>
<li><strong>Scan beyond IDS</strong>: if needed, use methods to scan beyond the detection systems</li>
<li><strong>Perform banner grabbing</strong>: grabbing from servers as well as perform OS fingerprinting</li>
<li><strong>Scan for vulnerabilities</strong>: using tools to look at the vulnerabilities of open systems</li>
<li><strong>Draw network diagrams</strong>: showing logical and physical pathways into networks</li>
<li><strong>Prepare proxies</strong>: obscuring efforts to keep you hidden</li>
</ol>
<h4 id="tcpip-transmission-control-protocolinternet-protocol">TCP/IP (Transmission Control Protocol/Internet Protocol)</h4>
<p><strong>TCP Flags</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">Flag</th>
<th style="text-align:left">Name</th>
<th style="text-align:left">Decimal number</th>
<th style="text-align:left">Function</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">SYN</td>
<td style="text-align:left">Synchronize</td>
<td style="text-align:left">2</td>
<td style="text-align:left">Set during initial communication. Negotiating of parameters and sequence numbers</td>
</tr>
<tr>
<td style="text-align:left">ACK</td>
<td style="text-align:left">Acknowledgment</td>
<td style="text-align:left">16</td>
<td style="text-align:left">Set as an acknowledgment to the SYN flag. Always set after initial SYN</td>
</tr>
<tr>
<td style="text-align:left">RST</td>
<td style="text-align:left">Reset</td>
<td style="text-align:left">4</td>
<td style="text-align:left">Forces the termination of a connection (in both directions)</td>
</tr>
<tr>
<td style="text-align:left">FIN</td>
<td style="text-align:left">Finish</td>
<td style="text-align:left">1</td>
<td style="text-align:left">Ordered close to communications</td>
</tr>
<tr>
<td style="text-align:left">PSH</td>
<td style="text-align:left">Push</td>
<td style="text-align:left">8</td>
<td style="text-align:left">Forces the delivery of data without concern for buffering</td>
</tr>
<tr>
<td style="text-align:left">URG</td>
<td style="text-align:left">Urgent</td>
<td style="text-align:left">32</td>
<td style="text-align:left">Data inside is being sent out of band. Example is canceling a message</td>
</tr>
</tbody>
</table>
<ul>
<li>How to remember TCP Flag&apos;s number</li>
</ul>
<pre><code class="lang-text">UAPRSF
000001 FIN
000010 SYN
000100 RST
001000 PSH
010000 ACK
100000 URG
</code></pre>
<p><strong>TCP Handshake</strong></p>
<ul>
<li>Connection establishment: SYN -&gt; SYN-ACK -&gt; ACK</li>
<li>Connection termination: FIN -&gt; ACK-FIN -&gt; ACK</li>
<li>Sequence and Acknowledgment numbers calculation:</li>
</ul>
<pre><code class="lang-text">  A.Seq = B.Ack
  A.Ack = B.Seq + B.Len + phantom byte

- Connection establishment:

  --------                  --------
  |Client|                  |Server|
  --------                  --------
     &#x2502;                         &#x2502;
     &#x2502;  SYN [Seq#=0, Ack#=0]   &#x2502;
     &#x2502;------------------------&gt;&#x2502;
     &#x2502;                         &#x2502;
     &#x2502;SYN, ACK [Seq#=0, Ack#=1]&#x2502;
     &#x2502;&lt;------------------------&#x2502;
     &#x2502;                         &#x2502;
     &#x2502;  ACK [Seq#=1, Ack#=1]   &#x2502;
     &#x2502;------------------------&gt;&#x2502;
  --------                  --------
  |Client|                  |Server|
  --------                  --------

  (SYN as 1 phantom byte)

- Data transfer:

  --------                            --------
  |Client|                            |Server|
  --------                            --------
     &#x2502;                                    &#x2502;
     &#x2502; PSH, ACK [Seq#=1, Ack#=1, Len=376] &#x2502;
     &#x2502;-----------------------------------&gt;&#x2502;
     &#x2502;                                    &#x2502;
     &#x2502;       ACK [Seq#=1, Ack#=377]       &#x2502;
     &#x2502;&lt;-----------------------------------&#x2502;
     &#x2502;                                    &#x2502;
     &#x2502;PSH, ACK [Seq#=1, Ack#=377, Len=270]&#x2502;
     &#x2502;&lt;-----------------------------------&#x2502;
     &#x2502;                                    &#x2502;
     &#x2502;      ACK [Seq#=377, Ack#=271]      &#x2502;
     &#x2502;-----------------------------------&gt;&#x2502;
  --------                            --------
  |Client|                            |Server|
  --------                            --------

- Connection termination (4-way TCP termination):

    - Server ends TCP session

    --------                      --------
    |Client|                      |Server|
    --------                      --------
       &#x2502;                             &#x2502;
       &#x2502;FIN, ACK [Seq#=271, Ack#=377]&#x2502;
       &#x2502;&lt;----------------------------&#x2502;
       &#x2502;                             &#x2502;
       &#x2502;  ACK [Seq#=377, Ack#=272]   &#x2502;
       &#x2502;----------------------------&gt;&#x2502;
    --------                      --------
    |Client|                      |Server|
    --------                      --------

    - Client ends TCP session

    --------                      --------
    |Client|                      |Server|
    --------                      --------
       &#x2502;                             &#x2502;
       &#x2502;FIN, ACK [Seq#=377, Ack#=272]&#x2502;
       &#x2502;----------------------------&gt;&#x2502;
       &#x2502;                             &#x2502;
       &#x2502;  ACK [Seq#=272, Ack#=378]   &#x2502;
       &#x2502;&lt;----------------------------&#x2502;
    --------                      --------
    |Client|                      |Server|
    --------                      --------

    (FIN as 1 phantom byte)
</code></pre>
<p><strong>Port Numbers</strong></p>
<ul>
<li><strong>Internet Assigned Numbers Authority</strong> (IANA): maintaining Service Name and Transport Protocol Port Number Registry which lists all port number reservations</li>
<li>Ranges<ul>
<li><strong>Well-known ports</strong>: 0-1023 (2^10)</li>
<li><strong>Registered ports</strong>: 1024-49,151</li>
<li><strong>Dynamic ports</strong>: 49,152-65,535 (2^16)</li>
</ul>
</li>
<li>A service is said to be <strong>listening</strong> for a port when it has that specific port open</li>
<li>Once a service has made a connection, the port is in an <strong>established</strong> state</li>
<li>Netstat: showing open ports on computer<ul>
<li>Display connections in numerical form: <code>netstat -an</code></li>
<li>Display executables tied to the open port (admin only): <code>netstat -b</code></li>
</ul>
</li>
<li>Some important port numbers</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">Port Number</th>
<th style="text-align:left">Protocol</th>
<th style="text-align:left">Transport Protocol</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">20/21</td>
<td style="text-align:left">FTP</td>
<td style="text-align:left">TCP</td>
</tr>
<tr>
<td style="text-align:left">22</td>
<td style="text-align:left">SSH</td>
<td style="text-align:left">TCP</td>
</tr>
<tr>
<td style="text-align:left">23</td>
<td style="text-align:left">Telnet</td>
<td style="text-align:left">TCP</td>
</tr>
<tr>
<td style="text-align:left">25</td>
<td style="text-align:left">SMTP</td>
<td style="text-align:left">TCP</td>
</tr>
<tr>
<td style="text-align:left">53</td>
<td style="text-align:left">DNS name lookup</td>
<td style="text-align:left">UDP</td>
</tr>
<tr>
<td style="text-align:left">53</td>
<td style="text-align:left">DNS zone transfer</td>
<td style="text-align:left">TCP</td>
</tr>
<tr>
<td style="text-align:left">67</td>
<td style="text-align:left">DHCP</td>
<td style="text-align:left">UDP</td>
</tr>
<tr>
<td style="text-align:left">69</td>
<td style="text-align:left">TFTP</td>
<td style="text-align:left">UDP</td>
</tr>
<tr>
<td style="text-align:left">80</td>
<td style="text-align:left">HTTP</td>
<td style="text-align:left">TCP</td>
</tr>
<tr>
<td style="text-align:left">88</td>
<td style="text-align:left">Kerberos</td>
<td style="text-align:left">TCP/UDP</td>
</tr>
<tr>
<td style="text-align:left">110</td>
<td style="text-align:left">POP3</td>
<td style="text-align:left">TCP</td>
</tr>
<tr>
<td style="text-align:left">123</td>
<td style="text-align:left">NTP</td>
<td style="text-align:left">TCP/UDP</td>
</tr>
<tr>
<td style="text-align:left">135</td>
<td style="text-align:left">RPC</td>
<td style="text-align:left">TCP</td>
</tr>
<tr>
<td style="text-align:left">137-139</td>
<td style="text-align:left">NetBIOS (SMB)</td>
<td style="text-align:left">TCP/UDP</td>
</tr>
<tr>
<td style="text-align:left">143</td>
<td style="text-align:left">IMAP</td>
<td style="text-align:left">TCP</td>
</tr>
<tr>
<td style="text-align:left">161/162</td>
<td style="text-align:left">SNMP</td>
<td style="text-align:left">UDP</td>
</tr>
<tr>
<td style="text-align:left">389</td>
<td style="text-align:left">LDAP</td>
<td style="text-align:left">TCP/UDP</td>
</tr>
<tr>
<td style="text-align:left">443</td>
<td style="text-align:left">HTTPS</td>
<td style="text-align:left">TCP</td>
</tr>
<tr>
<td style="text-align:left">445</td>
<td style="text-align:left">SMB</td>
<td style="text-align:left">TCP/UDP</td>
</tr>
<tr>
<td style="text-align:left">514</td>
<td style="text-align:left">SYSLOG</td>
<td style="text-align:left">UDP</td>
</tr>
<tr>
<td style="text-align:left">546</td>
<td style="text-align:left">dhcpv6</td>
<td style="text-align:left">TCP/UDP</td>
</tr>
<tr>
<td style="text-align:left">631</td>
<td style="text-align:left">IPP (Printing )</td>
<td style="text-align:left">TCP/UDP</td>
</tr>
<tr>
<td style="text-align:left">3268</td>
<td style="text-align:left">Global Catalog</td>
<td style="text-align:left">TCP/UDP</td>
</tr>
<tr>
<td style="text-align:left">5355</td>
<td style="text-align:left">LLMNR</td>
<td style="text-align:left">UDP</td>
</tr>
</tbody>
</table>
<p><strong>Subnetting</strong></p>
<ul>
<li><strong>IPv4 Main Address Types</strong><ul>
<li><strong>Unicast</strong>: acted on by a single recipient</li>
<li><strong>Multicast</strong>: acted on by members of a specific group</li>
<li><strong>Broadcast</strong>: acted on by everyone on the network<ul>
<li><strong>Limited</strong>: delivered to every system in the domain (255.255.255.255)</li>
<li><strong>Directed</strong>: delivered to all devices on a subnet and use that broadcast address</li>
</ul>
</li>
</ul>
</li>
<li><strong>Private addresses</strong>: 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16</li>
<li><strong>Subnet mask</strong>: determining how many address available on a specific subnet, also determining whether a destination system is on the same network as the source, represented by three methods:<ul>
<li><strong>Decimal</strong>: 255.240.0.0</li>
<li><strong>Binary</strong>: 11111111.11110000.00000000.00000000</li>
<li><strong>CIDR</strong> (Classless Inter-Domain Routing): x.x.x.x/12 (where x.x.x.x is an ip address on that range)</li>
<li>Network address: 1st address in the range, subnet mask bits + all 0s</li>
<li>Broadcast address: last address in the range, subnet mask bits + all 1s</li>
<li>Any other combination indicates an address in the range</li>
</ul>
</li>
<li><p>Subnet calculation:</p>
<pre><code class="lang-text">IP address: 130.192.202.202
Subnet mask: 255.255.248.0

- Step 1:
IP                | 10000010 11000000 11001010 11001010
Subnet mask       | 11111111 11111111 11111000 00000000

- Step 2:
Network Address   | 10000010 11000000 11001
Broadcast Address | 10000010 11000000 11001

- Step 3:
Network Address   | 10000010 11000000 11001000 00000000
Broadcast Address | 10000010 11000000 11001111 11111111

- Step 4:
Network Address: 130.192.200.0
Broadcast Address: 130.192.200.255
</code></pre>
<ul>
<li>Decimal to Binary:</li>
</ul>
<pre><code class="lang-text">  0  0  0  0 0 0 0 0
128 64 32 16 8 4 2 1
</code></pre>
</li>
</ul>
<h4 id="icmp-internet-control-message-protocol">ICMP (Internet Control Message Protocol)</h4>
<ul>
<li>ICMP is the easiest way to scan for live systems is through ICMP, but sometimes blocked on hosts that are actually live</li>
<li>Payload of an ICMP message can be anything (RFC never set what it was supposed to be); allows for covert channels</li>
<li><strong>Ping sweep</strong>: easiest method to identify hosts</li>
<li><strong>ICMP ECHO scanning</strong>: sending an ICMP ECHO Request to the network IP address, ping sweeping<ul>
<li>ICMP Type 3 Code 13 indicates that traffic is being blocked by router or firewall</li>
<li>ICMP Type 3 Code 3 indicates that the client itself has the port closed</li>
</ul>
</li>
</ul>
<p><strong>Message Types</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">ICMP Message Type</th>
<th style="text-align:left">Description and Codes</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0: Echo Reply</td>
<td style="text-align:left">Answer to a Type 8 Echo Request</td>
</tr>
<tr>
<td style="text-align:left">3: Destination Unreachable</td>
<td style="text-align:left">Error message followed by these codes:</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">0 - Destination network unreachable</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">1 - Destination host unreachable</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">2 - protocol unreachable</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">3 - port unreachable</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">6 - Network unknown</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">7 - Host unknown</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">9 - Network administratively prohibited</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">10 - Host administratively prohibited</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">13 - Communication administratively prohibited</td>
</tr>
<tr>
<td style="text-align:left">4: Source Quench</td>
<td style="text-align:left">A congestion control message</td>
</tr>
<tr>
<td style="text-align:left">5: Redirect</td>
<td style="text-align:left">Sent when there are two or more gateways available for the sender to use</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">0 - Redirect datagram for the network</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">1 - Redirect datagram for the host</td>
</tr>
<tr>
<td style="text-align:left">8: Echo Request</td>
<td style="text-align:left">A ping message, requesting an echo reply</td>
</tr>
<tr>
<td style="text-align:left">11: Time Exceeded</td>
<td style="text-align:left">Packet took too long to be routed (code 0 is TTL expired)</td>
</tr>
</tbody>
</table>
<p><strong>Ping scanning tools</strong></p>
<ul>
<li>Nmap: virtually always does a ping sweep with scans unless you turn it off</li>
<li>Angry IP Scanner</li>
<li>SolarWinds Engineer Toolkit</li>
<li>Advanced IP Scanner</li>
<li>Pinkie</li>
</ul>
<h4 id="vulnerability-scanning">Vulnerability Scanning</h4>
<ul>
<li>Using complex or simple tools runs against a target to determine vulnerabilities</li>
<li>Tools<ul>
<li>Nessus: industry standard</li>
<li>GFI LanGuard</li>
<li>Qualys</li>
<li>FreeScan - best known for testing websites and applications</li>
<li>OpenVAS - best competitor to Nessus and is free</li>
</ul>
</li>
</ul>
<h3 id="enumeration">Enumeration</h3>
<ul>
<li>Listing the items that are found within a specific target</li>
<li>Always active by nature</li>
</ul>
<h4 id="netbios-network-basic-inputoutput-system-enumeration">NetBIOS (Network Basic Input/Output System) Enumeration</h4>
<ul>
<li>NetBIOS provides name servicing, connectionless communication and some Session layer stuff</li>
<li>NetBIOS is the browser service in Windows designed to host information about all machines within domain or TCP/IP network segment</li>
<li>NetBIOS name is a <strong>16-character ASCII string</strong> used to identify devices Of those 16 characters, 15 are used for the device name, and the remaining character is reserved for the service name or name record type</li>
<li>NetBIOS name resolution doesn&apos;t work on IPv6</li>
<li>nbtstat (on Windows)<ul>
<li>Local table: <code>nbtstat -n</code></li>
<li>Remote information: <code>nbtstat -A &lt;IPADDRESS&gt;</code></li>
<li>Cache information: <code>netstat -c</code></li>
</ul>
</li>
<li>Other Tools<ul>
<li>SuperScan</li>
<li>Hyena</li>
<li>NetBIOS Enumerator</li>
<li>NSAuditor</li>
</ul>
</li>
</ul>
<p><strong>NetBIOS code and meaning</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">Code</th>
<th style="text-align:left">Type</th>
<th style="text-align:left">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">UNIQUE</td>
<td style="text-align:left">Hostname</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">GROUP</td>
<td style="text-align:left">Domain name</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">UNIQUE</td>
<td style="text-align:left">Windows Messenger service</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">UNIQUE</td>
<td style="text-align:left">Domain master browser</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">GROUP</td>
<td style="text-align:left">Domain controller</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">UNIQUE</td>
<td style="text-align:left">Master browser for subnet</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">UNIQUE</td>
<td style="text-align:left">File Service</td>
</tr>
</tbody>
</table>
<h4 id="snmp-simple-network-management-protocol-enumeration">SNMP (Simple Network Management Protocol) Enumeration</h4>
<ul>
<li>Used for network device management and uses both an agent and a manager to ensure logging and control<ul>
<li>Agents are embedded in every network device</li>
<li>Manager is installed on a separate computer</li>
</ul>
</li>
<li>There is a read-only and a read-write version<ul>
<li>Default read-only string is <strong>public</strong></li>
<li>Default read-write string is <strong>private</strong></li>
</ul>
</li>
<li>SNMP uses <strong>community strings</strong> which function as passwords, sent in cleartext unless using SNMP v3</li>
<li><strong>Management Information Base</strong> (MIB): database that stores information, it uses ASN.1 (Abstract Syntax Notation One)</li>
<li><strong>Object Identifiers</strong> (OID): identifiers for information stored in MIB</li>
<li><strong>SNMP GET</strong>: getting information about the system</li>
<li><strong>SNMP SET</strong>: setting information about the system</li>
<li><strong>Types of objects</strong><ul>
<li><strong>Scalar</strong>: single object</li>
<li><strong>Tabular</strong>: multiple related objects that can be grouped together</li>
</ul>
</li>
<li>Tools<ul>
<li>Engineer&apos;s Toolset</li>
<li>SNMPScanner</li>
<li>OpUtils 5: includes SNMP tools</li>
<li>SNScan</li>
</ul>
</li>
</ul>
<h4 id="smtp-simple-mail-transfer-protocol-enumeration">SMTP (Simple Mail Transfer Protocol) Enumeration</h4>
<ul>
<li>VRFY: verifying email addresses; code 200 success, code 550 failure</li>
<li>EXPN: providing actual delivery address of mailing list and aliases</li>
<li>RCPT TO: defining recipients</li>
</ul>
<h4 id="ntp-network-time-protocol-enumeration">NTP (Network Time Protocol) Enumeration</h4>
<ul>
<li>Querying can give you list of systems connected to the server name and IP</li>
<li>Tools<ul>
<li>NTP Server Scanner</li>
<li>AtomSync</li>
</ul>
</li>
<li>Commands<ul>
<li>ntptrace</li>
<li>ntpdc</li>
<li>ntpq</li>
</ul>
</li>
</ul>
<h4 id="ldap-lightweight-directory-access-protocol-enumeration">LDAP (Lightweight Directory Access Protocol) Enumeration</h4>
<ul>
<li>Connecting on 389 to a Directory System Agent (DSA)</li>
<li>Returning information such as valid user names, domain information, addresses, telephone numbers, system data, organization structure and other items, interface with Active Directory (AD)</li>
<li>Tools<ul>
<li>Softerra</li>
<li>JXplorer</li>
<li>Lex (The LDAP Explorer)</li>
<li>LDAP Admin Tool</li>
</ul>
</li>
</ul>
<h3 id="nmap">Nmap</h3>
<h4 id="full-connect-scan">Full connect scan</h4>
<ul>
<li><code>nmap -sT</code></li>
<li>TCP connect or full open scan</li>
<li>Full connection and then tears down with RST</li>
<li>Easiest to detect, but most reliable</li>
</ul>
<h4 id="tcp-syn-scan-stealth-scan">TCP SYN scan (Stealth scan)</h4>
<ul>
<li><code>nmap -sS</code></li>
<li>Half-open scan or stealth scan</li>
<li>Only sending SYN packets</li>
<li>Using abruptly ended connection before the three-way handshake</li>
<li>Hiding efforts and evading firewalls</li>
</ul>
<p><strong>Responses to Full and SYN scan probe</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">Probe Response</th>
<th style="text-align:left">Assigned State</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">TCP SYN/ACK packet</td>
<td style="text-align:left">open</td>
</tr>
<tr>
<td style="text-align:left">TCP RST packet</td>
<td style="text-align:left">closed</td>
</tr>
</tbody>
</table>
<h4 id="inverse-tcp-flag-scan-fin-urg-and-psh-scanning">Inverse TCP flag scan (FIN, URG and PSH scanning)</h4>
<ul>
<li>Using FIN, URG or PSH flag</li>
<li>Setting just TCP FIN bit, do FIN scan: <code>nmap -sF</code></li>
</ul>
<h4 id="null-scan">NULL scan</h4>
<ul>
<li><code>nmap -sN</code></li>
<li>TCP flag header is 0, no flag set</li>
<li>Not working against systems where RFC 793 is not implemented</li>
</ul>
<h4 id="xmas-scan">Xmas scan</h4>
<ul>
<li><code>nmap -sX</code></li>
<li>All flags (FIN, PSH and URG) are turned on so it&apos;s &quot;lit up&quot; like a Christmas tree</li>
<li>Not working against Windows machines</li>
</ul>
<p><strong>Responses to a NULL, FIN, or Xmas scan</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">Probe Response</th>
<th style="text-align:left">Assigned State</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">No response received (even after retransmissions)</td>
<td style="text-align:left">open or filtered</td>
</tr>
<tr>
<td style="text-align:left">TCP RST packet</td>
<td style="text-align:left">closed</td>
</tr>
<tr>
<td style="text-align:left">ICMP unreachable error (type 3, code 1, 2, 3, 9, 10, or 13)</td>
<td style="text-align:left">filtered</td>
</tr>
</tbody>
</table>
<h4 id="tcp-ack-scan">TCP ACK scan</h4>
<ul>
<li>ACK scan: <code>nmap -sA</code></li>
<li>Window scan: <code>nmap -sW</code></li>
<li>Probe packets with ACK flag set and a random sequence number to a recipient host</li>
<li>Multiple methods<ul>
<li>TTL version: If TTL of RST packet &lt; 64, port is open</li>
<li>Window version: If the Window on RST packet is anything other than 0, port is open</li>
</ul>
</li>
<li>Can be used to check filtering: If ACK is sent and no response, stateful firewall present</li>
</ul>
<h4 id="idle-scan">IDLE Scan</h4>
<ul>
<li><code>nmap -sI &lt;zombie host&gt;</code></li>
<li>Using a third party (zombie) to check if a port is open, exploits a side-channel</li>
<li>Only working if third party isn&apos;t transmitting data, in IDLE state</li>
<li>IPID gives the information about port open/closed:<ul>
<li>Port closed: IPID increase of 1</li>
<li>Port open: IPID increase of 2</li>
<li>IPID increase of anything greater indicates zombie was not idle</li>
</ul>
</li>
</ul>
<pre><code class="lang-text">- Step 1: Sending request to Zombie, getting IPID
             SYN/ACK
    Attacker -------&gt; Zombie
             &lt;-------
             RST IPID=x

- Step 2: Sending a spoofed packet to target, target is responding to Zombie
             SYN IP=Zombie
    Attacker -------&gt; Target
    Zombie   &lt;------- Target
             SYN/ACK
    Zombie   -------&gt; Target
             RST IPID=x+1

- Step 3: Sending request to Zombie again, getting IPID
             SYN/ACK
    Attacker -------&gt; Zombie
             &lt;-------
             RST IPID=x+2
</code></pre>
<h4 id="nmap-switches">Nmap Switches</h4>
<table>
<thead>
<tr>
<th style="text-align:left">Switch</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">-sA</td>
<td style="text-align:left">ACK scan</td>
</tr>
<tr>
<td style="text-align:left">-sF</td>
<td style="text-align:left">FIN scan</td>
</tr>
<tr>
<td style="text-align:left">-sI</td>
<td style="text-align:left">IDLE scan</td>
</tr>
<tr>
<td style="text-align:left">-sL</td>
<td style="text-align:left">DNS scan (list scan)</td>
</tr>
<tr>
<td style="text-align:left">-sN</td>
<td style="text-align:left">NULL scan</td>
</tr>
<tr>
<td style="text-align:left">-sO</td>
<td style="text-align:left">Protocol scan (tests which IP protocols respond)</td>
</tr>
<tr>
<td style="text-align:left">-sP/sn</td>
<td style="text-align:left">Ping scan</td>
</tr>
<tr>
<td style="text-align:left">-sS</td>
<td style="text-align:left">TCP SYN scan</td>
</tr>
<tr>
<td style="text-align:left">-sT</td>
<td style="text-align:left">TCP connect scan, full scan</td>
</tr>
<tr>
<td style="text-align:left">-sW</td>
<td style="text-align:left">Window scan</td>
</tr>
<tr>
<td style="text-align:left">-sX</td>
<td style="text-align:left">XMAS scan</td>
</tr>
<tr>
<td style="text-align:left">-PE/PP/PM</td>
<td style="text-align:left">ICMP ECHO, timestamp, and netmask request discovery probes</td>
</tr>
<tr>
<td style="text-align:left">-P0/PN/Pn</td>
<td style="text-align:left">No ping</td>
</tr>
<tr>
<td style="text-align:left">-PS</td>
<td style="text-align:left">TCP SYN/ACK to given ports</td>
</tr>
<tr>
<td style="text-align:left">-oN</td>
<td style="text-align:left">Normal output</td>
</tr>
<tr>
<td style="text-align:left">-oX</td>
<td style="text-align:left">XML output</td>
</tr>
<tr>
<td style="text-align:left">-A</td>
<td style="text-align:left">OS detection, version detection, script scanning and traceroute</td>
</tr>
<tr>
<td style="text-align:left">-F</td>
<td style="text-align:left">Fast mode - Scan fewer ports than the default scan</td>
</tr>
<tr>
<td style="text-align:left">-f</td>
<td style="text-align:left">Fragment packets</td>
</tr>
<tr>
<td style="text-align:left">-S</td>
<td style="text-align:left">Spoof source address</td>
</tr>
<tr>
<td style="text-align:left">-O</td>
<td style="text-align:left">Enable OS detection</td>
</tr>
<tr>
<td style="text-align:left">-T0 through -T2</td>
<td style="text-align:left">Serial scans. T0 is slowest</td>
</tr>
<tr>
<td style="text-align:left">-T3 through -T5</td>
<td style="text-align:left">Parallel scans. T3 is slowest. T3 is default level</td>
</tr>
</tbody>
</table>
<h3 id="hping">hping</h3>
<ul>
<li><code>hping3 -1 &lt;IPaddress&gt;</code></li>
<li>Powerful ping sweep and port scanning tool</li>
<li>Can craft packets</li>
</ul>
<h4 id="hping-switch-and-description">hping switch and description</h4>
<table>
<thead>
<tr>
<th style="text-align:left">Switch</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">-1</td>
<td style="text-align:left">Sets ICMP mode</td>
</tr>
<tr>
<td style="text-align:left">-2</td>
<td style="text-align:left">Sets UDP mode</td>
</tr>
<tr>
<td style="text-align:left">-8</td>
<td style="text-align:left">Sets scan mode. Expects port range without -p flag</td>
</tr>
<tr>
<td style="text-align:left">-9</td>
<td style="text-align:left">Listen mode. Expects signature (e.g. HTTP) and interface (-I eth0)</td>
</tr>
<tr>
<td style="text-align:left">--flood</td>
<td style="text-align:left">Sends packets as fast as possible without showing incoming replies</td>
</tr>
<tr>
<td style="text-align:left">-Q</td>
<td style="text-align:left">Collects sequence numbers generated by the host</td>
</tr>
<tr>
<td style="text-align:left">-p</td>
<td style="text-align:left">Sets port number</td>
</tr>
<tr>
<td style="text-align:left">-F</td>
<td style="text-align:left">Sets the FIN flag</td>
</tr>
<tr>
<td style="text-align:left">-S</td>
<td style="text-align:left">Sets the SYN flag</td>
</tr>
<tr>
<td style="text-align:left">-R</td>
<td style="text-align:left">Sets the RST flag</td>
</tr>
<tr>
<td style="text-align:left">-P</td>
<td style="text-align:left">Sets the PSH flag</td>
</tr>
<tr>
<td style="text-align:left">-A</td>
<td style="text-align:left">Sets the ACK flag</td>
</tr>
<tr>
<td style="text-align:left">-U</td>
<td style="text-align:left">Sets the URG flag</td>
</tr>
<tr>
<td style="text-align:left">-X</td>
<td style="text-align:left">Sets the XMAS scan flags</td>
</tr>
</tbody>
</table>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="02-reconnaissance_and_footprinting.html" class="navigation navigation-prev " aria-label="Previous page: 02-Reconnaissance and Footprinting">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="04-sniffing_and_evasion.html" class="navigation navigation-next " aria-label="Next page: 04-Sniffing and Evasion">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"03-Scanning and Enumeration","level":"1.4","depth":1,"next":{"title":"04-Sniffing and Evasion","level":"1.5","depth":1,"path":"04-sniffing_and_evasion.md","ref":"04-sniffing_and_evasion.md","articles":[]},"previous":{"title":"02-Reconnaissance and Footprinting","level":"1.3","depth":1,"path":"02-reconnaissance_and_footprinting.md","ref":"02-reconnaissance_and_footprinting.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["advanced-emoji"],"pluginsConfig":{"advanced-emoji":{"embedEmojis":false},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"03-scanning_and_enumeration.md","mtime":"2020-06-27T08:19:41.665Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-07-05T07:09:45.423Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

